# Pre-commit Rules (Ruff + Mypy)

Code must pass `uv run pre-commit run --all-files`. Follow these to avoid common failures.

## Ruff

- **SIM102**: Prefer one `if` with `and` over nested `if`s. Combine conditions into a single condition.
- **C901**: Function complexity must be â‰¤ 10. Extract helper functions or use early `continue`/`return` to reduce branches.
- **Ruff format**: Line length 98, double quotes, trailing commas. Run `ruff format` if needed.

## Mypy

- **attr-defined**: Before using `.value`, `.attr`, `.id` on AST nodes, narrow the type (e.g. `isinstance(node.func, ast.Attribute)` then assign to a local or use `node.func` so mypy knows it is `ast.Attribute`).
- **arg-type**: When adding to `set[str]`, ensure the value is `str` (e.g. `ast.Constant.value` can be other types; use `isinstance(x, str)` before `set.add(x)`).

## Before committing

Run:

```bash
uv run pre-commit run --all-files
```

Re-run after fixes and re-stage any modified files.
